<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Цифровизация инвентаризации</title>
    <!-- Подключение Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- Подключение вашего внешнего CSS файла -->
    <link href="{{ url_for('static', filename='styles.css') }}" rel="stylesheet">
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-12 text-center">
                <h5>Цифровизация инвентаризации</h5>
            </div>
        </div>
        <div class="row">
            <div class="col-3">
                <form action="/upload" method="post" enctype="multipart/form-data">
                    <input type="file" name="excelFile">
                    <input type="submit" value="Upload">
                </form>
                <div id="dataDisplay"></div>
                <script>
                    document.querySelector('form').addEventListener('submit', function(e) {
                        e.preventDefault();
                        const formData = new FormData(this);
                        fetch('/upload', {
                            method: 'POST',
                            body: formData,
                        })
                        .then(response => response.json())
                        .then(data => {
                            const displayDiv = document.getElementById('dataDisplay');
                            // Преобразование данных в HTML и отображение их на странице
                            let htmlContent = '<ul>';
                            data.forEach(row => {
                                htmlContent += '<li>' + JSON.stringify(row) + '</li>';
                            });
                            htmlContent += '</ul>';
                            displayDiv.innerHTML = htmlContent;
                        })
                        .catch(error => console.error('Error:', error));
                    });
                </script>
            </div>
            <div class="col-6 text-center">
                <div class="video-frame">
                    <iframe src="{{ url_for('video_feed') }}" frameborder="0"></iframe>
                </div>
                <div class="slider-container">
                    <div class="slider">
                        <div class="label-container"><span>Верхняя левая точка</span></div>
                        <label for="x1">X1:<span id="x1_val">{{ x1 }}</span></label>
                        <input type="range" class="form-control" id="x1" name="x1" min="0" max="688" value="{{ x1 }}">
                        <label for="y1">Y1: <span id="y1_val">{{ y1 }}</span></label>
                        <input type="range" class="form-control" id="y1" name="y1" min="0" max="400" value="{{ y1 }}">
                    </div>
                    <div class="slider">
                        <div class="label-container"><span>Нижняя правая точка</span></div>
                        <label for="x2">X2: <span id="x2_val">{{ x2 }}</span></label>
                        <input type="range" class="form-control" id="x2" name="x2" min="0" max="688" value="{{ x2 }}">
                        <label for="y2">Y2: <span id="y2_val">{{ y2 }}</span></label>
                        <input type="range" class="form-control" id="y2" name="y2" min="0" max="400" value="{{ y2 }}">
                    </div>
                    <button id="captureImageButton" class="btn btn-primary mt-2">Захватить изображение</button>
                </div>
            </div>
            <div class="col-2 text-center">
                <div id="imageContainer">
                    <h6>Черно-белое изображение</h6>
                    <div class="square">
                        <img id="capturedImage" src="" alt="Captured Image" style="display: none;">
                    </div>
                    <h6>Пороговое изображение</h6>
                    <div class="square">
                        <img id="threshImage" src="" alt="Thresholded Image" style="display: none;">
                    </div>
                    <div class="slider">
                        <label for="threshold">Пороговое значение: <span id="threshold_val">128</span></label>
                        <input type="range" class="form-control" id="threshold" name="threshold" min="0" max="255" value="128">
                    </div>
                    <h6>Распознанный номер образца оружия</h6>
                    <div class="square">
                        <div id="recognizedText"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Подключение Bootstrap JS и зависимостей -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <!-- Подключение вашего внешнего JS файла -->
    <script src="{{ url_for('static', filename='capture.js') }}"></script>
</body>
</html>